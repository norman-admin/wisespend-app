<!-- Header Principal Redise√±ado -->
<header class="dashboard-header">
    <div class="header-content">
        <div class="header-left">
            <h1 class="dashboard-title">Gastos Familiares - Junio 2025</h1>
            <!-- El selector de per√≠odo se inserta autom√°ticamente aqu√≠ por JavaScript -->
        </div>
        <div class="header-right">
            <!-- Men√∫ de Usuario -->
            <div class="user-menu" id="user-menu">
                <button class="user-menu-trigger" id="user-menu-trigger">
                    <span class="user-icon">üë§</span>
                    <span class="user-name">Norman</span>
                    <span class="dropdown-arrow">‚ñº</span>
                </button>
                
                <div class="user-dropdown" id="user-dropdown">
                    <div class="user-dropdown-content">
                        <a href="#" class="user-menu-item" id="view-profile">
                            <span class="menu-icon">üë§</span>
                            <span class="menu-text">Ver Perfil</span>
                        </a>
                        <a href="#" class="user-menu-item" id="configuration">
                            <span class="menu-icon">‚öôÔ∏è</span>
                            <span class="menu-text">Configuraci√≥n</span>
                        </a>
                        <a href="#" class="user-menu-item" id="go-to-reports">
                            <span class="menu-icon">üìä</span>
                            <span class="menu-text">Ir a Reportes</span>
                        </a>
                        <a href="#" class="user-menu-item" id="create-user">
                            <span class="menu-icon">‚ûï</span>
                            <span class="menu-text">Crear Nuevo Usuario</span>
                        </a>
                        <div class="menu-separator"></div>
                        <a href="#" class="user-menu-item logout" id="logout">
                            <span class="menu-icon">üö™</span>
                            <span class="menu-text">Cerrar Sesi√≥n</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
// ===== FUNCIONALIDAD DEL MEN√ö DE USUARIO =====
document.addEventListener('DOMContentLoaded', function() {
    // Esperar un poco para que el componente se cargue
    setTimeout(function() {
        const userMenuTrigger = document.getElementById('user-menu-trigger');
        const userDropdown = document.getElementById('user-dropdown');
        
        if (userMenuTrigger && userDropdown) {
            // Toggle del men√∫
            userMenuTrigger.addEventListener('click', function(e) {
                e.stopPropagation();
                const isOpen = userDropdown.classList.contains('open');
                
                if (isOpen) {
                    closeUserMenu();
                } else {
                    openUserMenu();
                }
            });
            
            // Cerrar al hacer clic fuera
            document.addEventListener('click', function(e) {
                const userMenu = document.getElementById('user-menu');
                if (userMenu && !userMenu.contains(e.target)) {
                    closeUserMenu();
                }
            });
            
            // Manejadores de men√∫
            setupUserMenuHandlers();
            
            console.log('üë§ Men√∫ de usuario configurado correctamente');
        } else {
            console.warn('‚ö†Ô∏è Elementos del men√∫ de usuario no encontrados');
        }
        
        function openUserMenu() {
            userDropdown.classList.add('open');
            userMenuTrigger.classList.add('open');
        }
        
        function closeUserMenu() {
            userDropdown.classList.remove('open');
            userMenuTrigger.classList.remove('open');
        }
        
        function setupUserMenuHandlers() {
            // Ver Perfil
            const viewProfile = document.getElementById('view-profile');
            if (viewProfile) {
                viewProfile.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeUserMenu();
                    console.log('üßë Abrir perfil de usuario');
                    alert('Funci√≥n "Ver Perfil" en desarrollo');
                });
            }
            
            // Configuraci√≥n
            const configuration = document.getElementById('configuration');
            if (configuration) {
                configuration.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeUserMenu();
                    console.log('‚öôÔ∏è Abrir configuraci√≥n');
                    if (window.dashboardOrchestrator) {
                        window.dashboardOrchestrator.loadSection('configuration');
                    } else {
                        alert('Funci√≥n "Configuraci√≥n" en desarrollo');
                    }
                });
            }
            
            // Ir a Reportes
            const goToReports = document.getElementById('go-to-reports');
            if (goToReports) {
                goToReports.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeUserMenu();
                    console.log('üìä Abrir reportes');
                    if (window.dashboardOrchestrator) {
                        window.dashboardOrchestrator.loadSection('reports');
                    } else {
                        alert('Funci√≥n "Reportes" en desarrollo');
                    }
                });
            }
            
            // Crear Nuevo Usuario
            const createUser = document.getElementById('create-user');
            if (createUser) {
                createUser.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeUserMenu();
                    console.log('‚ûï Crear nuevo usuario');
                    alert('Funci√≥n "Crear Nuevo Usuario" en desarrollo');
                });
            }
            
            // Cerrar Sesi√≥n
            const logout = document.getElementById('logout');
            if (logout) {
                logout.addEventListener('click', function(e) {
                    e.preventDefault();
                    closeUserMenu();
                    
                    if (confirm('¬øEst√°s seguro de que quieres cerrar sesi√≥n?')) {
                        console.log('üö™ Cerrando sesi√≥n...');
                        
                        if (window.dashboardOrchestrator) {
                            window.dashboardOrchestrator.handleLogout();
                        } else {
                            window.location.href = 'index.html';
                        }
                    }
                });
            }
        }
    }, 500);
});

console.log('üé® Header redise√±ado cargado - Men√∫ de usuario funcional');
</script>